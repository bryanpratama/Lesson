<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Konversi Angka ke Terbilang</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px 15px;
      margin: 0;
    }

    h1 {
      color: #333;
      margin-bottom: 20px;
    }

    input {
      padding: 10px;
      font-size: 18px;
      width: 300px;
      border-radius: 5px;
      border: 1px solid #ccc;
      text-align: right;
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    #hasil {
      margin-top: 20px;
      font-size: 18px;
      color: #444;
      max-width: 600px;
      text-align: center;
      word-wrap: break-word;
    }

    #copyButton {
      display: none;
      margin-top: 10px;
      background-color: #28a745;
    }

    #copyButton:hover {
      background-color: #1e7e34;
    }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #323232;
      color: #fff;
      padding: 12px 20px;
      border-radius: 6px;
      opacity: 0;
      pointer-events: none;
      transform: translateY(20px);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 16px;
      z-index: 9999;
    }

    .toast.show {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }

    .history-container {
      margin-top: 30px;
      width: 100%;
      max-width: 600px;
    }

    .history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .history-header h2 {
      font-size: 20px;
      color: #333;
    }

    .history-list {
      margin-top: 10px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 10px;
      max-height: 200px;
      overflow-y: auto;
    }

    .history-item {
      padding: 8px;
      border-bottom: 1px solid #eee;
      cursor: pointer;
    }

    .history-item:last-child {
      border-bottom: none;
    }

    .history-item:hover {
      background-color: #f0f0f0;
    }

    .clear-btn {
      background-color: #dc3545;
      font-size: 14px;
      padding: 5px 10px;
    }

    .clear-btn:hover {
      background-color: #c82333;
    }
  </style>
</head>
<body>
  <h1>Konversi Angka ke Terbilang</h1>
  <input type="text" id="inputAngka" placeholder="Masukkan angka besar..." oninput="formatAngka(this)">
  <button onclick="konversi()">Konversi</button>
  <div id="hasil"></div>
  <button id="copyButton" onclick="copyHasil()">Copy Hasil</button>

  <div class="toast" id="toast">
    ðŸ“‹ Hasil disalin ke clipboard!
  </div>

  <div class="history-container">
    <div class="history-header">
      <h2>Riwayat Konversi</h2>
      <button class="clear-btn" onclick="clearRiwayat()">Hapus Semua</button>
    </div>
    <div class="history-list" id="historyList"></div>
  </div>

  <script>
    const satuan = ["", "satu", "dua", "tiga", "empat", "lima", "enam", "tujuh", "delapan", "sembilan"];
    const belasan = ["sepuluh", "sebelas", "dua belas", "tiga belas", "empat belas", "lima belas", "enam belas", "tujuh belas", "delapan belas", "sembilan belas"];
    const puluhan = ["", "", "dua puluh", "tiga puluh", "empat puluh", "lima puluh", "enam puluh", "tujuh puluh", "delapan puluh", "sembilan puluh"];
    const skala = ["", "ribu", "juta", "miliar", "triliun", "kuadriliun", "kuintiliun", "sekstiliun", "septiliun", "oktiliun", "noniliun", "desiliun", "undesiliun", "duodesiliun", "tresdesiliun", "kuattuordesiliun", "kuinquadesiliun", "seksdesiliun", "septendesiliun", "oktodesiliun", "novemdesiliun", "vigisiliun", "unvigintiliun", "duovigintiliun"];

    function angkaKeKata(num) {
      if (num === 0n) return "nol";
      let hasil = "";
      let grup = 0;

      while (num > 0n) {
        let tigaDigit = num % 1000n;
        if (tigaDigit > 0n) {
          let bagian = konversiTigaDigit(Number(tigaDigit)) + (skala[grup] ? " " + skala[grup] : "");
          hasil = bagian + (hasil ? " " + hasil : "");
        }
        num = num / 1000n;
        grup++;
      }

      return hasil.trim();
    }

    function konversiTigaDigit(num) {
      if (num === 0) return "";
      if (num < 10) return satuan[num];
      if (num < 20) return belasan[num - 10];
      if (num < 100) return puluhan[Math.floor(num / 10)] + (num % 10 !== 0 ? " " + satuan[num % 10] : "");

      let ratusan = Math.floor(num / 100);
      let sisa = num % 100;
      let ratusanKata = ratusan === 1 ? "seratus" : satuan[ratusan] + " ratus";
      return ratusanKata + (sisa !== 0 ? " " + konversiTigaDigit(sisa) : "");
    }

    function formatAngka(el) {
      let angka = el.value.replace(/\D/g, "");
      let formatted = angka.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
      let cursorPos = el.selectionStart;
      let prevLength = el.value.length;
      el.value = formatted;
      let diff = formatted.length - prevLength;
      el.setSelectionRange(cursorPos + diff, cursorPos + diff);
    }

    function konversi() {
      const input = document.getElementById("inputAngka").value.trim().replace(/\./g, "");
      const hasilEl = document.getElementById("hasil");
      const copyBtn = document.getElementById("copyButton");

      try {
        let num = BigInt(input);
        let max = BigInt("9".repeat(75));
        if (num > max) {
          hasilEl.innerText = "Maaf, angka terlalu besar! Maksimum adalah 999 duovigintiliun.";
          copyBtn.style.display = "none";
        } else {
          const hasil = angkaKeKata(num);
          hasilEl.innerText = hasil;
          copyBtn.style.display = "inline-block";
          simpanRiwayat(input, hasil);
        }
      } catch (e) {
        hasilEl.innerText = "Masukkan angka yang valid!";
        copyBtn.style.display = "none";
      }
    }

    function copyHasil() {
      const hasilText = document.getElementById("hasil").innerText;
      navigator.clipboard.writeText(hasilText).then(() => {
        showToast();
      });
    }

    function showToast() {
      const toast = document.getElementById("toast");
      toast.classList.add("show");
      setTimeout(() => {
        toast.classList.remove("show");
      }, 3000);
    }

    function simpanRiwayat(angka, hasil) {
      let riwayat = JSON.parse(localStorage.getItem("riwayatKonversi") || "[]");
      riwayat.unshift({ angka, hasil });
      if (riwayat.length > 10) riwayat = riwayat.slice(0, 10); // max 10 riwayat
      localStorage.setItem("riwayatKonversi", JSON.stringify(riwayat));
      tampilkanRiwayat();
    }

    function tampilkanRiwayat() {
      const list = document.getElementById("historyList");
      list.innerHTML = "";
      let riwayat = JSON.parse(localStorage.getItem("riwayatKonversi") || "[]");
      riwayat.forEach(item => {
        const div = document.createElement("div");
        div.className = "history-item";
        div.innerText = `${item.angka} â†’ ${item.hasil}`;
        div.onclick = () => {
          document.getElementById("inputAngka").value = formatWithDots(item.angka);
          konversi();
        };
        list.appendChild(div);
      });
    }

    function formatWithDots(angka) {
      return angka.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    function clearRiwayat() {
      localStorage.removeItem("riwayatKonversi");
      tampilkanRiwayat();
    }

    // Tampilkan saat load
    tampilkanRiwayat();
  </script>
</body>
</html>
